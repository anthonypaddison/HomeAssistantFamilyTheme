# Side Bar Button Template
sb_icon_only:
  variables:
    section: ""
    badge_entity: ""
  show_name: false
  show_icon: true
  custom_fields:
    badge: >
      [[[
        const e = variables.badge_entity ? states[variables.badge_entity] : null;
        const n = e && e.state ? Number(e.state) : 0;
        return n > 0 ? `${n}` : null;
      ]]]
  styles:
    card:
      - height: 75px
      - border-radius: 0
      - box-shadow: none
      - background: var(--sb-inactive-bg) !important
      - color: var(--sb-inactive-icon) !important
      - place-items: center
      - padding: 8px 4px
      - transition: transform .05s ease
      - overflow: visible
    icon:
      - width: 58px
      - height: 58px
    custom_fields:
      badge:
        - position: absolute
        - bottom: 3px
        - right: 3px
        - min-width: 15px
        - height: 15px
        - border-radius: 15px
        - background: white
        - color: "#0F172A"
        - font-weight: 800
        - font-size: 12px
        - display: flex
        - align-items: center
        - justify-content: center
        - border: 1px solid #0F172A
        - overflow: visible
  state:
    - operator: template
      value: '[[[ return states["input_select.family_section"]?.state === variables.section; ]]]'
      styles:
        card:
          - background: var(--sb-active-bg)
          - color: var(--sb-active-icon)

# Top heading sections aka Chips
due_today_progress_chip:
  show_icon: true
  show_name: true
  show_state: false
  tap_action:
    action: none
  variables:
    name: ""
    icon: mdi:checkbox-marked-circle
    color: var(--primary-color)
    completed: ""
    outstanding: ""
  name: '[[[ return variables.name || ""; ]]]'
  icon: '[[[ return variables.icon || "mdi:checkbox-marked-circle"; ]]]'
  styles:
    card:
      - padding: 13px
      - border-radius: 10px
      - background: '[[[ return variables.color ?? "var(--primary-color)"; ]]]'
      - min-height: 36px
      - box-shadow: none
    grid:
      - grid-template-areas: "'i n v' 'bar bar bar'"
      - grid-template-columns: 20px auto auto
      - grid-template-rows: auto 4px
      - column-gap: 8px
    img_cell:
      - align-self: center
      - justify-self: start
      - grid-area: i
    icon:
      - width: 30px
      - height: 30px
      - color: '#0F172A'
      - padding: 3px
    name:
      - grid-area: n
      - align-self: center
      - justify-self: start
      - font-weight: '800'
      - color: '#0F172A'
      - font-size: 15px
      - line-height: 19px
      - padding: 3px
    custom_fields:
      v:
        - grid-area: v
        - align-self: center
        - justify-self: end
        - font-size: 15px
        - font-weight: 800
        - color: '#0F172A'
        - margin: 3px
      bar:
        - grid-area: bar
        - width: 100%
        - height: 10px
        - border-radius: 15px
        - background: 'rgba(0,0,0,.15)'
        - position: relative
        - overflow: hidden
        - margin: 3px
        - margin-bottom: 6px
  custom_fields:
    v: >
      [[[
        const done = Number(states[variables.completed]?.state ?? 0);
        const rem  = Number(states[variables.outstanding]?.state ?? 0);
        const total = Math.max(0, done + rem);
        return `${done}/${total}`;
      ]]]
    bar: >
      [[[
        const done = Number(states[variables.completed]?.state ?? 0);
        const rem  = Number(states[variables.outstanding]?.state ?? 0);
        const total = Math.max(0, done + rem);
        const pct = total ? Math.min(100, Math.round(done / total * 100)) : 0;
        return `<div style="position:absolute;inset:0;background:rgba(255,255,255,.85);transform-origin:left;transform:scaleX(${pct/100});"></div>`;
      ]]]
