type: vertical-stack
view_layout: { grid-area: sidebar }
card_mod:
  style: |
    /* Make the sidebar card act like a sticky column and fill the viewport below HA header */
    ha-card {
      background: transparent;   /* items themselves carry the header background */
      margin: 0 !important;
      border-radius: 0 !important;
      border: none !important;
      box-shadow: none !important;
      height: calc(100vh - var(--header-height)) !important;
      position: sticky;
      top: 0;
      padding: 0 !important;
    }
    /* Remove default stack spacing so items butt up neatly */
    ha-card .card-content > * { margin: 0 !important; }

cards:

  # --- Family Icon (top) â€” toggles HA main sidebar
  - type: custom:button-card
    template: family_icon
    icon: mdi:home-heart
    tap_action:
      action: call-service
      service: browser_mod.javascript
      data:
        code: |
          (function(){
            const root = document.querySelector('home-assistant');
            if (root) root.dispatchEvent(new CustomEvent('hass-toggle-menu', {bubbles:true, composed:true}));
          })();

  # --- Calendar (align with bottom of header + chips row)
  - type: custom:button-card
    template: sb_icon_only
    icon: mdi:calendar
    styles:
      card:
        - margin-top: "calc(var(--family-heading-height,56px) + var(--family-chips-height,56px))"
    variables:
      section: Calendar
      badge_entity: input_number.events_today
    tap_action:
      action: call-service
      service: input_select.select_option
      target: { entity_id: input_select.family_section }
      data: { option: Calendar }

  # --- Chores (badge = total incomplete across lists)
  - type: custom:button-card
    template: sb_icon_only
    icon: mdi:broom
    variables:
      section: Chores
      badge_entity: sensor.chores_incomplete_total
    tap_action:
      action: call-service
      service: input_select.select_option
      target: { entity_id: input_select.family_section }
      data: { option: Chores }

  # --- Photos
  - type: custom:button-card
    template: sb_icon_only
    icon: mdi:image-multiple
    variables:
      section: Photos
    tap_action:
      action: call-service
      service: input_select.select_option
      target: { entity_id: input_select.family_section }
      data: { option: Photos }

  # --- Lists
  - type: custom:button-card
    template: sb_icon_only
    icon: mdi:format-list-bulleted
    variables:
      section: Lists
    tap_action:
      action: call-service
      service: input_select.select_option
      target: { entity_id: input_select.family_section }
      data: { option: Lists }

  # --- Toby (bottom cluster)
  - type: custom:button-card
    template: sb_icon_only
    icon: mdi:robot-happy-outline
    variables:
      section: Toby
    styles:
      card:
        - margin-top: auto
    tap_action:
      action: call-service
      service: input_select.select_option
      target: { entity_id: input_select.family_section }
      data: { option: Toby }

  # --- Lizzie
  - type: custom:button-card
    template: sb_icon_only
    icon: mdi:unicorn-variant
    variables:
      section: Lizzie
    tap_action:
      action: call-service
      service: input_select.select_option
      target: { entity_id: input_select.family_section }
      data: { option: Lizzie }
